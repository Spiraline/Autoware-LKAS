<launch>
  <arg name="ndt_lkas_flag" value="true" />

  <!-- pure_pursuit  -->
  <include file="$(find pure_pursuit)/launch/pure_pursuit.launch">    
    <!-- Core Parameter -->
    <arg name="lookahead_ratio"               value="0.0"/>
    <arg name="minimum_lookahead_distance"    value="5.0"/>
    
    <arg name="const_velocity"                value="5.0"/>     
    <arg name="const_lookahead_distance"      value="4.0"/>
    <arg name="is_linear_interpolation"       value="True"/>
    <arg name="publishes_for_steering_robot"  value="True"/>
    <arg name="add_virtual_end_waypoints"     value="False"/>
    <arg name="dynamic_params_path"           value="$(env HOME)/spiraline_ws/cfg/dynamic_pure_pursuit.yaml" />
  </include>

  <!-- twist_filter -->
  <include file="$(find twist_filter)/launch/twist_filter.launch">    
    <!-- For twist_filter -->
    <arg name="wheel_base" default="2.7" />
    <arg name="lateral_accel_limit" default="5.0" />
    <arg name="lateral_jerk_limit" default="5.0" />
    <arg name="lowpass_gain_linear_x" default="0.0" />
    <arg name="lowpass_gain_angular_z" default="0.0" />
    <arg name="lowpass_gain_steering_angle" default="0.0" />
    <arg name="max_stop_count" default="40" /> <!-- 10 = 1 second -->  
    <!-- For twist_gate -->
    <arg name="loop_rate" default="30.0" />
    <arg name="use_decision_maker" default="False" />
    <arg name="twist_topic" default="/twist_cmd_merged" />
  </include>

  <node pkg="lkas" type="lkas.py" name="lkas" output="screen">
    <param name="output_topic" value="twist_cmd_lkas"/>
    <param name="debug_window" value="False"/>
    <param name="res_t_log"    value="False"/>
  </node>

  <include file="$(find lkas)/launch/twist_combiner.launch">
    <arg name="ndt_lkas_flag"        value="$(arg ndt_lkas_flag)" />
    <arg name="pnorm_threshold"      value="0.05" />
    <arg name="score_threshold"      value="3.0" />
  </include>
  
</launch>